# AWS Config Rules Development Kit (aws-config-rdk)

# Overview #
The **AWS Config Rules Development Kit** (or **aws-config-rdk**) is a command line interface (CLI) to help set up, author and test custom AWS Config rules.

With **aws-config-rdk**, you can evaluate the configuration settings of your AWS resources. You do this by creating AWS Config rules, which represent your ideal configuration settings. AWS Config provides customizable, predefined rules called managed rules to help you get started. You can also create your own custom rules. For more information, [see the AWS Config documentation](http://docs.aws.amazon.com/config/latest/developerguide/evaluate-config.html).

# Getting Started

**aws-config-rdk** requires you to have AWS security credentials. For procedures to get security credentials, [see the documentation](http://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html)

## Install the AWS Config RDK##
Install the aws-config-rdk by downloading/cloning the official project repository from https://github.com/awslabs/aws-config-rdk, for more details see the [Installation](#Installation) section below.

## Initialize new custom rule ##

You will now initialize a custom AWS Config rule. You will create this new custom rule with a specific name, which will then create a folder in your current path with a custom rule template for you to begin creating your rule. For instance, the following command:

`aws-config-rdk init hello-world`

will generate a subfolder named hello-world containing Python 3 scripts that will be combined to create your new custom rule. 
---
*While other AWS Lambda runtime languages are supported, we have chosen Python 3 to demonstrate the aws-config-rdk workflow. To find out further options for initializing your new custom rule, see the [CLI Reference](#CLI-Reference) below.*
---

## Edit the custom rule ##
TODO

## Test the custom rule locally ##
TODO `aws-config-rdk test hello-world`

## Deploy the custom rule ##
TODO `aws-config-rdk deploy hello-world`

## Test the custom rule in production ##
TODO

# CLI Reference #
The core command -- `aws-config-rdk` -- provides the following functionality

## Creating New Config Rules ##
`aws-config-rdk create` creates a new AWS Config rule from a language-specific template

It contains scripts to enable AWS Config, create a Config rule and test it with sample ConfigurationItems. 

See more specific README and instructions within each operating system's directory.

# Rule Structure #
TODO describe the components of the custom rules that will have been generated by the create command

# CLI Reference #

The aws-config-rdk command consists of a number of subcommands that represent different actions related to the lifecycle and monitoring of custom AWS Config rules in your AWS environment.

## init ##

The `init` subcommand helps to correctly configure your AWS enviroment to create and use custon AWS Config rules. Those steps include:

- enabling AWS Config

The subcommand runs with defaults for 

This subcommand should be run when first initializing your AWS environment and is only required once per AWS account in which you intend to run AWS Config rules.

## create ##

The `create` subcommand is the first step to creating a new custom rule. Additional arguments can be specified as follows:

`create {rule-name}` - creates a new directory named {rule-name} containing configuration files and scripts
that will be used to create the underlying AWS Lambda function with common defaults for language runtime (python3.6) and trigger type ('periodic') for the custom rule. These defaults can be overridden with appropriate switches. Those switches are demonstrated below, where the two commands that follow are equivalent:

- `aws-config-rdk create hello-world`
- `aws-config-rdk create hello-world --runtime python3.6 --periodic`

### create --runtime ###
The `--runtime` switch specifies the AWS Lambda runtime for the custom AWS rule. You can choose the specific programming language for your rule based on the possible AWS Lambda runtimes available, as [listed here](http://docs.aws.amazon.com/cli/latest/reference/lambda/create-function.html) under the Runtime argument description. If you do not specify an AWS Lambda runtime, the default of `python3.6` will be used. For instance, the following commands are equivalent:
- `aws-config-rdk create hello-world`
- `aws-config-rdk create hello-world --runtime python3.6`

For a custom rule using the most NodeJS runtime, you would specify:
`aws-config-rdk create hello-world --runtime nodejs6.10`

### create --periodic {frequency} ###
**The `--periodic` switch cannot be used with the `--event` switch, and if `--event` is not specified, the default case is `--periodic`.**

The `--periodic` switch specifies the trigger type for executing the custom rule as one based on periodic frequency. If no {frequency} is provided, the default {frequency} of TwentyFour_Hours will be used, meaning that the rule will be run on a periodic basis within one day maximum frequency. Possible values for {frequency} include:

- One_Hour
- Three_Hours
- Six_Hours
- Twelve_Hours
- TwentyFour_Hours

For more information, see [AWS Config documentation](http://docs.aws.amazon.com/config/latest/APIReference/API_ConfigRule.html) for more details.

## create --event ##
**The `--periodic` switch cannot be used with the `--event` switch, and if `--event` is not specified, the default case is `--periodic`.**

TODO describe invoking events here

While AWS Config supports invoking AWS Config rules based on many events related to changes in resources such as those listed in the [Cloudformation resource types](http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html), not all resource types are currently supported -- for more information, see the [AWS Config documentation](http://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_develop-rules_nodejs.html#creating-custom-rules-for-additional-resource-types)

## deploy ##
TODO

# Installation #
You can install the **AWS Config Rules Development Kit** by downloading the source code directly from the official project site, located [here](https://github.com/awslabs/aws-config-rdk).

Once downloaded, you can add the appropriate project path  to your default path as follows (where {project path} is the location where the source code was downloaded):

- For Linux/Mac OS: 
    - `export PATH=$PATH:{project path}/MacLinux`
- For Windows OS:
    - `set PATH=%PATH%;{project path}/Windows`

To make these changes permanent, you can alter your system path depending on your specific operating system and system shell.

## Testing the installation
From your command line/shell, test that the aws-config-rdk is correctly installed, and confirm the most recent version, by entering:

`aws-config-rdk --version`

If your installation worked correctly and is updated, you should see the following result:

`AWS Config Rules DevelopmentKit v0.0.1`

## Testing the AWS environment
You can test that your AWS environment is reachable and has AWS Config enabled

`aws-config-rdk --check-env`

If your AWS environment is reachable, you should see a diagnostic result similar to the following:

```
AWS Environment Summary
-----------------------
AWS Account: 012345678901
AWS Config: Enabled
```

where values for AWS Account will reflect your AWS Account.

If `AWS Config: Disabled` is displayed, you will need to enable AWS Config via the `aws-config-rdk init` command, which will enable AWS Config and necessary components for deploying and running AWS Config rules.